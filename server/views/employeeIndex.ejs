<script src='/js/employeeForm.js'></script>
<% include partials/head %>

<div class="container">
  <h1>Employee List</h1>
  <% if (array) { %>
    <ul class="collection">
      <% for (var result in array) { %>
        <li class="collection-item">
          <% id = array[result]._id %>
          <a class="employee-delete secondary-content" onClick="deleteRequest('<%= id %>')" href=""><i class="material-icons">delete</i></a>
          <%= array[result].name %>
          <p><%= array[result].description %></p>
        </li>
      <% } %>
    </ul>
  <% } %>

  <div id="employee-form-div"></div>

  <div id="add-employee">
    <button class="btn waves-effect waves-light right" id="employee-form" onClick="loadForm()">Add Employee
      <i class="material-icons right">add</i>
    </button>
  </div>
  
</div>

<% include partials/foot %>

<script>
  function deleteRequest(id) {
    $.ajax({
      type: 'DELETE',
      url: `http://localhost:3000/employee/${id}`
    });
    location.reload();
  }
</script> 

<script>
  function loadForm() {
    var template = $('#employee-form-template').html();
    $("#employee-form-div").append(template);
    $('#add-employee').remove();
  };
</script>

<script id='employee-form-template' type="text/template">
  <div class="row card-panel">
    <h3>Add an employee</h3>
    <form method="post" action="/employees">
      <div class="input-field">
        <input id="name" type="text" class="validate" name="name">
        <label for="name">Employee Name</label>
      </div>
      <div class="input-field">
        <input id="jobTitle" type="text" class="validate" name="jobTitle">
        <label for="jobTitle">Job Title</label>
      </div>
      <button class="btn waves-effect waves-light right" type="submit" name="action">Submit
        <i class="material-icons right">send</i>
      </button>
    </form>
  </div>
</script>